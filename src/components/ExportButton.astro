---
interface Props {
  platform: string;
  description: string;
  text: string;
  filename: string;
  instructions: string;
}

const { platform, description, text, filename, instructions } = Astro.props;
---

<div class="border border-forge-border dark:border-forge-border-dark rounded-lg p-4">
  <div class="flex items-start justify-between gap-3">
    <div class="min-w-0">
      <p class="font-medium text-sm flex items-center gap-1.5">
        <span class="w-2 h-2 rounded-full bg-indigo-500 dark:bg-indigo-400 shrink-0" aria-hidden="true"></span>
        {platform}
      </p>
      <p class="text-xs text-forge-muted dark:text-forge-muted-dark mt-0.5">{description}</p>
    </div>
    <div class="flex gap-1.5 shrink-0">
      <button
        type="button"
        class:list={[
          "copy-btn inline-flex items-center gap-1 px-2.5 py-1.5 text-xs font-medium rounded-lg",
          "bg-indigo-600 dark:bg-indigo-500 text-white",
          "hover:bg-indigo-700 dark:hover:bg-indigo-600",
          "transition-colors cursor-pointer",
        ]}
        data-copy-text={text}
      >
        <svg class="w-3.5 h-3.5 copy-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9.75a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184" />
        </svg>
        <svg class="w-3.5 h-3.5 check-icon hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
        </svg>
        <span class="copy-label">Copy</span>
      </button>
      <button
        type="button"
        class:list={[
          "download-btn inline-flex items-center gap-1 px-2.5 py-1.5 text-xs font-medium rounded-lg",
          "bg-stone-200 dark:bg-stone-700 text-forge-text dark:text-forge-text-dark",
          "hover:bg-stone-300 dark:hover:bg-stone-600",
          "transition-colors cursor-pointer",
        ]}
        data-download-text={text}
        data-download-filename={filename}
      >
        <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
        </svg>
        <span>{filename}</span>
      </button>
    </div>
  </div>
  <details class="mt-2">
    <summary class="text-xs text-forge-muted dark:text-forge-muted-dark cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors select-none">
      How to use
    </summary>
    <p class="mt-1.5 text-xs text-forge-muted dark:text-forge-muted-dark leading-relaxed">
      {instructions}
    </p>
  </details>
</div>

<style>
  .copy-btn.copied {
    background-color: #16a34a;
  }
  :global(.dark) .copy-btn.copied {
    background-color: #22c55e;
  }
  .copy-btn.copied .copy-icon {
    display: none;
  }
  .copy-btn.copied .check-icon {
    display: block;
  }
</style>
